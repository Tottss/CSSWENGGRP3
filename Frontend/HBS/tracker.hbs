<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{title}}</title>

  <link rel="stylesheet" href="../CSS/global.css" />
  <link rel="stylesheet" href="../CSS/tracker.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
</head>

<body>
  {{> navbar}}
  <!-- Sidebar -->
  {{> sidebar}}

  <!-- Main Content -->
  <main class="main-content" class="alert-box">
    <div class="tracker-wrapper">
      <div class="tracker-card">
        <h2 class="tracker-header">Update Impact Tracker</h2>

        <!-- Project Dropdown -->
        <div class="form-group">
          <label for="projectSelect">Project</label>
          <select id="projectSelect">
              <option value="">Select Project</option>
              {{#each projects}}
                  <option value="{{this.project_id}}">{{this.project_name}}</option>
              {{/each}}
          </select>
        </div>

        <p class="last-update">Last Update Period: {{lastUpdate}}</p>

        <!-- Beneficiary Stats Section -->
        <section class="beneficiary-stats">
        <h2>Beneficiaries Served</h2>

        <table class="beneficiary-table">
      <tr>
        <td><label for="actualValue">Actual Beneficiaries Served</label></td>
        <td><input type="number" id="actualValue" value="0" min="0" /></td>
      </tr>

      <tr>
        <td><label for="targetValue">Target Beneficiaries</label></td>
        <td><input type="number" id="targetValue" value="0" min="0" /></td>
      </tr>
    </table>

        <div class="bar-graph">
            <div class="bar-row">
            <span class="bar-label">Actual Beneficiaries Served</span>
            <div class="bar-bg">
                <div class="bar-fill actual" id="actualBar">0</div>
            </div>
            </div>

            <div class="bar-row">
            <span class="bar-label">Target Beneficiaries</span>
            <div class="bar-bg">
                <div class="bar-fill target" id="targetBar">0</div>
            </div>
            </div>
        </div>
        </section>


        <!-- Budget Section -->
        <section class="budget-section">
          <table class="budget-table">
              <thead>
              <tr>
                  <th>Project Amount (Budget)</th>
                  <th>Expense to Date</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                  <td><input type="number" id="projectBudget" value="{{budget}}" placeholder="Enter total budget" /></td>
                  <td><input type="number" id="expenseToDate" value="{{expense}}" placeholder="Enter expenses so far" /></td>
              </tr>
              </tbody>
          </table>
        </section>


        <!-- Progress Section -->
        <div class="progress-section">
          <h3>Progress Meter (%)</h3>
          <div class="progress-meter">
            <div class="progress-circle">
              <svg viewBox="0 0 36 36">
                <path class="bg" d="M18 2.0845a15.9155 15.9155 0 0 1 0 31.831a15.9155 15.9155 0 0 1 0-31.831" />
              </svg>

              <!-- HBS OUTPUT (default value) -->
              <span id="progressText" class="progress-text">
                {{#if progress}}
                  {{progress}}%
                {{else}}
                  0%
                {{/if}}
              </span>
            </div>

            <!-- Replace BLANK with HBS output -->
            <p id="progressLabel" class="progress-subtext">
              {{#if progress}}
                {{progress}}% Progress Reported
              {{else}}
                0% Progress Reported
              {{/if}}
            </p>
          </div>
        </div>

        <!-- Auto-Filled Fields -->
        <div class="form-group">
          <label>Advocacy Area</label>
          <input type="text" id="advocacyArea" value="{{advocacyArea}}" readonly />
        </div>

        <div class="form-group">
          <label>SDG Alignment</label>
          <input type="text" id="sdgAlignment" value="{{sdgAlignment}}" readonly />
        </div>

        <div class="form-group">
          <label>Community Partner Location</label>
          <input type="text" name="communityLocation" id="communityLocation" value="{{communityLocation}}" />
        </div>


        <!-- Narrative Update -->
        <div class="form-group">
          <label>Narrative Update (Progress, Challenges, Lessons)</label>
          <textarea rows="4" placeholder="Write your update here..." id="narrativeField" ></textarea>
        </div>

        <!-- Upload Section -->
        <div class="form-group upload-group">
          <label>Upload Photos / Reports</label>
          <input type="file" name="uploads" multiple />
        </div>

        <!-- Change Display Picture-->
        <div class="form-group upload-group">
          <label>Upload Display Photo</label>
          <input type="file" name="display_photo" accept="image/*" multiple>

          <!-- Preview -->
          <img id="displayPhotoPreview" src="/ASSETS/default_project.jpg"
            style="max-width:150px; margin-top:10px; border-radius:8px;">
        </div>

        <!-- Save Button -->
        <button id="saveImpact" class="save-btn" type="button">Save Edits</button>
      </div>
    </div>
  </main>

  <script src="../JAVASCRIPT/impactTracker.js"></script>
</body>
</html>
