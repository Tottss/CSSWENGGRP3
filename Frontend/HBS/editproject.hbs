<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{title}}</title>

  <link rel="stylesheet" href="../CSS/global.css" />
  <link rel="stylesheet" href="../CSS/editproject.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
</head>

<body>
  {{> navbar}}
  <!-- Sidebar -->
  {{> sidebar}}

    <!-- Main Content -->
    <main class="main-content">
    <div class="editproject-wrapper">
        <div class="editproject-card">
        <form id="editProjectForm" method="POST" enctype="multipart/form-data">


            <h2 class="section-header">Project Details</h2>
            <!-- Project Title & Organization -->
            <label>Project Title</label>
            <input type="text" name="projtitle" class="myproject-header" value="{{projtitle}}" required />
            <label>Organization</label>
            <input type="text" name="orgName" class="org-name-input" value="{{orgName}}" required />

            <!-- Project Image -->
            <label>Change Display Photo</label>
            {{#if projimage}}
            <img src="{{projimage}}" alt="Project Image" class="project-image-preview"/>
            {{/if}}
            <input type="file" name="projimage" accept="image/*" />

            <!-- Project Description -->
            <label>Project Description</label>
            <textarea name="ProjectDesc" rows="5">{{ProjectDesc}}</textarea>

            <!-- Key Fields -->
            <label>Target Beneficiaries</label>
            <input type="number" name="nBeneficiaries" value="{{nBeneficiaries}}" />

            <label>Advocacy Area</label>
            <input type="text" name="Advocacyarea" value="{{Advocacyarea}}" />

            <label>SDG Alignment</label>
            <input type="text" name="SDG_alignment" value="{{SDG_alignment}}" />

            <label>Timeline</label>
            <input type="text" name="Timeline" value="{{Timeline}}" />

            <label>Project Amount (Budget)</label>
            <input type="text" name="Budget" value="{{Budget}}" />

            <!-- Proposal -->
            <label>Detailed Proposal (PDF)</label>
            <input type="file" name="Proposal" accept=".pdf" />
            {{#if Proposal}}
            <iframe src="{{Proposal}}" width="100%" height="200" style="border:1px solid #e6e6e6; border-radius:8px;"></iframe>
            <a href="{{Proposal}}" target="_blank" class="download-btn" download>Download Existing PDF</a>
            {{/if}}

            <!-- Impact Tracker -->
            <h2 class="section-header">Impact Tracker</h2>
            <p class="last-update">Last Update Period: {{lastUpdate}}</p>

            <!-- Beneficiary Stats Section -->
            <section class="beneficiary-stats">
            <h2>Beneficiaries Served</h2>

            <table class="beneficiary-table">
            <tr>
                <td><label for="actualValue">Actual Beneficiaries Served</label></td>
                <td><input type="number" id="actualValue" value="0" min="0" /></td>
            </tr>

            <tr>
                <td><label for="targetValue">Target Beneficiaries</label></td>
                <td><input type="number" id="targetValue" value="0" min="0" /></td>
            </tr>
            </table>

            <div class="bar-graph">
                <div class="bar-row">
                <span class="bar-label">Actual Beneficiaries Served</span>
                <div class="bar-bg">
                    <div class="bar-fill actual" id="actualBar">0</div>
                </div>
                </div>

                <div class="bar-row">
                <span class="bar-label">Target Beneficiaries</span>
                <div class="bar-bg">
                    <div class="bar-fill target" id="targetBar">0</div>
                </div>
                </div>
            </div>
            </section>


            <!-- Budget Section -->
            <section class="budget-section">
            <table class="budget-table">
                <thead>
                <tr>
                    <th>Project Amount (Budget)</th>
                    <th>Expense to Date</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><input type="number" id="projectBudget" value="{{budget}}" placeholder="Enter total budget" /></td>
                    <td><input type="number" id="expenseToDate" value="{{expense}}" placeholder="Enter expenses so far" /></td>
                </tr>
                </tbody>
            </table>
            </section>


            <!-- Progress Section -->
            <div class="progress-section">
            <h3>Progress Meter (%)</h3>
            <div class="progress-meter">
                <div class="progress-circle">
                <svg viewBox="0 0 36 36">
                    <path class="bg" d="M18 2.0845a15.9155 15.9155 0 0 1 0 31.831a15.9155 15.9155 0 0 1 0-31.831" />
                </svg>

                <!-- HBS OUTPUT (default value) -->
                <span id="progressText" class="progress-text">
                    {{#if progress}}
                    {{progress}}%
                    {{else}}
                    0%
                    {{/if}}
                </span>
                </div>

                <!-- Replace BLANK with HBS output -->
                <p id="progressLabel" class="progress-subtext">
                {{#if progress}}
                    {{progress}}% Progress Reported
                {{else}}
                    0% Progress Reported
                {{/if}}
                </p>
            </div>
            </div>

            <!-- Auto-Filled Fields -->
            <div class="form-group">
            <label>Community Partner Location</label>
            <input type="text" name="communityLocation" id="communityLocation" value="{{communitylocation}}" readonly/>
            </div>


            <!-- Narrative Update -->
            <div class="form-group">
            <label>Narrative Update (Progress, Challenges, Lessons)</label>
            <textarea rows="4" placeholder="Write your update here..." id="narrativeField" ></textarea>
            </div>

            <!-- Upload Section -->
            <div class="form-group upload-group">
            <label>Upload Photos / Reports</label>
            <input type="file" name="files" multiple />
            </div>

            <!-- Save Button -->
            <button id="saveImpact" class="save-btn" type="button">Save Edits</button>
        </div>
        </div>

    <script src="../JAVASCRIPT/viewProject.js"></script>
    </main>
